<Window x:Class="View.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:View"
        xmlns:vm="clr-namespace:View.ViewModel"
        xmlns:com="clr-namespace:View.ViewModel.Commands"
        xmlns:con="clr-namespace:View.ViewModel.Converters"
        mc:Ignorable="d"
        Title="Contacts" Height="450" Width="650" MinWidth="630" MinHeight="380" MaxWidth="820" MaxHeight="700" Icon="/contacts_96x96.ico">
    <Window.Resources>
        <vm:MainVM x:Key="mainVM"/>
        <vm:AddCommand x:Key="addCommand" mainVM="{StaticResource mainVM}"/>
        <com:EditCommand x:Key="editCommand" mainVM="{StaticResource mainVM}"/>
        <com:RemoveCommand x:Key="removeCommand" mainVM="{StaticResource mainVM}"/>
        <com:ApplyCommand x:Key="applyCommand" mainVM="{StaticResource mainVM}"/>
        <con:SelectedIndexToCurrentContactConverter x:Key="IndexToContactConverter"/>
        <con:ModeToReadOnlyConverter x:Key="ModeToReadOnlyConverter"/>
        <con:AvailabilityToVisibilityConverter x:Key="AvailabilityToVisibilityConverter"/>
    </Window.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3.5*" MinWidth="170" MaxWidth="350"/>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="6.5*"/>
        </Grid.ColumnDefinitions>
        <Border Grid.Column="0" Grid.RowSpan="2" Background="#f8f8f8">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="30"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="35"/>
                </Grid.RowDefinitions>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock x:Name="FindTextBlock" Grid.Column="0" Text="Find:" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="8 3 3 3"/>
                    <TextBox x:Name="FindTextBox" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="3 3 8 3"/>
                </Grid>
                <ListBox x:Name="ContactsListBox" 
                         Grid.Column="0" 
                         Grid.Row="1" 
                         Margin="8 5 8 5"
                         DataContext="{StaticResource mainVM}" 
                         ItemsSource="{Binding Contacts}" 
                         SelectedIndex="{Binding Path=Contacts, Converter={StaticResource IndexToContactConverter}, ConverterParameter={StaticResource mainVM}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         DisplayMemberPath="Name"/>
                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Button x:Name="AddButton" Content="Add"  Grid.Column="0" Height="25" Margin="8 0 3 3" VerticalAlignment="Center" IsEnabled="{Binding Source={StaticResource addCommand}, Path=Availability, Mode=OneWay}"/>
                    <Button x:Name="EditButton" Content="Edit" Grid.Column="1" Height="25" Margin="3 0 3 3"  VerticalAlignment="Center" IsEnabled="{Binding Source={StaticResource editCommand}, Path=Availability, Mode=OneWay}"/>
                    <Button x:Name="RemoveButton" Content="Remove" Grid.Column="2" Height="25" Margin="3 0 8 3" VerticalAlignment="Center" IsEnabled="{Binding Source={StaticResource removeCommand}, Path=Availability, Mode=OneWay}"/>
                </Grid>
            </Grid>
        </Border>
        <GridSplitter Grid.Column="1" Grid.RowSpan="2" Width="5" HorizontalAlignment="Center" Background="White"/>
        <Grid Grid.Column="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto"/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Image Grid.Column="0" Width="100" Height="100"  Margin="8 35 8 8" VerticalAlignment="Top" Source="/Resources/Person.png"/>
            <StackPanel Grid.Column="1">
                <TextBlock x:Name="NameTextBlock" Text="Name:" Margin="8 8 0 3"/>
                <TextBox x:Name="NameTextBox" Margin="8" IsReadOnly="{Binding Source={StaticResource mainVM}, Path=Mode, Mode=OneWay, Converter={StaticResource ModeToReadOnlyConverter}}" Text="{Binding Source={StaticResource mainVM}, Path=Name, Mode=OneWay}"/>
                <TextBlock x:Name="PhoneNumberTextBlock" Text="PhoneNumber:" Margin="8 8 0 3"/>
                <TextBox x:Name="PhoneNumberTextBox" Margin="8" IsReadOnly="{Binding Source={StaticResource mainVM}, Path=Mode, Mode=OneWay, Converter={StaticResource ModeToReadOnlyConverter}}" Text="{Binding Source={StaticResource mainVM}, Path=PhoneNumber, Mode=OneWay}"/>
                <TextBlock x:Name="EmailTextBlock" Text="Email" Margin="8 8 0 3"/>
                <TextBox x:Name="EmailTextBox" Margin="8" IsReadOnly="{Binding Source={StaticResource mainVM}, Path=Mode, Mode=OneWay, Converter={StaticResource ModeToReadOnlyConverter}}" Text="{Binding Source={StaticResource mainVM}, Path=Email, Mode=OneWay}"/>
                <Button x:Name="ApplyButton" Content="Aplly" Width="75" Height="25" Margin="8 50 0 0" HorizontalAlignment="Left" Visibility="{Binding Source={StaticResource applyCommand}, Path=Availability, Mode=OneWay, Converter={StaticResource AvailabilityToVisibilityConverter}}"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>